(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7310:e=>{"use strict";e.exports=require("url")},1778:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>h,tree:()=>o});var a=s(7096),r=s(6132),l=s(7284),n=s.n(l),i=s(2564),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3982)),"/Users/dhiraja/Documents/Projects/backroom/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,5345)),"/Users/dhiraja/Documents/Projects/backroom/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/dhiraja/Documents/Projects/backroom/app/page.tsx"],x="/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3762:(e,t,s)=>{Promise.resolve().then(s.bind(s,6575))},6575:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Home});var a=s(784),r=s(9885),l=s(9458),n=s(1129),i=s(7004),d=s(2032),o=s(7),c=s(4409);function InventoryDashboard(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(!0),[n,x]=(0,r.useState)({totalSkus:0,totalOnHand:0,avgDailySales:0,lowStockItems:0});(0,r.useEffect)(()=>{fetchInventoryData()},[]);let fetchInventoryData=async()=>{try{l(!0);let e=await fetch("/api/inventory/real"),s=await e.json();if(e.ok){t(s);let e=s.length,a=s.reduce((e,t)=>e+t.on_hand,0),r=s.reduce((e,t)=>e+t.avg_daily_sales,0)/s.length,l=s.filter(e=>e.on_hand<50).length;x({totalSkus:e,totalOnHand:a,avgDailySales:Math.round(100*r)/100,lowStockItems:l})}else throw Error(s.error||"Failed to fetch inventory data")}catch(e){console.error("Error fetching inventory data:",e),t([]),x({totalSkus:0,totalOnHand:0,avgDailySales:0,lowStockItems:0})}finally{l(!1)}};return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:a.jsx("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(i.Z,{className:"h-6 w-6 text-gray-400"})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Unique SKUs"}),a.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.totalSkus})]})})]})})}),a.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:a.jsx("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(d.Z,{className:"h-6 w-6 text-green-400"})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total On-Hand"}),a.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.totalOnHand.toLocaleString()})]})})]})})}),a.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:a.jsx("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(o.Z,{className:"h-6 w-6 text-blue-400"})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Daily Sales"}),a.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.avgDailySales})]})})]})})}),a.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:a.jsx("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(c.Z,{className:"h-6 w-6 text-yellow-400"})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Low Stock Items"}),a.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.lowStockItems})]})})]})})})]}),(0,a.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[(0,a.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[a.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Inventory Overview"}),a.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Current inventory levels and sales data"})]}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"On Hand"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Backroom"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Shelf"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Daily Sales"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lead Time"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.sku}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.product_name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.on_hand}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.backroom_units}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.shelf_units}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.avg_daily_sales}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.lead_time_days," days"]})]},e.sku))})]})})]})]})}var x=s(6315),m=s(1831);function UploadSection(){let[e,t]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),[n,i]=(0,r.useState)("idle"),[o,c]=(0,r.useState)(""),h=(0,r.useRef)(null),handleDrag=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?t(!0):"dragleave"===e.type&&t(!1)},handleFile=e=>{"text/csv"===e.type||e.name.endsWith(".csv")?(l(e),i("idle"),c("")):(i("error"),c("Please upload a CSV file"))},handleUpload=async()=>{if(s){i("uploading"),c("");try{let e=new FormData;e.append("file",s),await new Promise(e=>setTimeout(e,2e3)),i("success"),c("File uploaded and processed successfully!")}catch(e){i("error"),c("Upload failed. Please try again.")}}},resetUpload=()=>{l(null),i("idle"),c(""),h.current&&(h.current.value="")};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upload Inventory CSV"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Upload a CSV file with columns: sku, product_name, on_hand, backroom_units, shelf_units, avg_daily_sales, lead_time_days"}),(0,a.jsxs)("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center ${e?"border-blue-400 bg-blue-50":s?"border-green-400 bg-green-50":"border-gray-300"}`,onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:e=>{e.preventDefault(),e.stopPropagation(),t(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&handleFile(e.dataTransfer.files[0])},children:[a.jsx("input",{ref:h,type:"file",accept:".csv",onChange:e=>{e.target.files&&e.target.files[0]&&handleFile(e.target.files[0])},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),s?(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(d.Z,{className:"mx-auto h-12 w-12 text-green-400"}),a.jsx("p",{className:"text-sm font-medium text-green-600",children:s.name}),(0,a.jsxs)("p",{className:"text-xs text-green-500",children:[(s.size/1024).toFixed(1)," KB"]})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(x.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium text-blue-600 hover:text-blue-500",children:"Click to upload"})," ","or drag and drop"]}),a.jsx("p",{className:"text-xs text-gray-500",children:"CSV files only"})]})]}),o&&a.jsx("div",{className:`mt-4 p-4 rounded-md ${"success"===n?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:"success"===n?a.jsx(d.Z,{className:"h-5 w-5 text-green-400"}):a.jsx(m.Z,{className:"h-5 w-5 text-red-400"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:`text-sm font-medium ${"success"===n?"text-green-800":"text-red-800"}`,children:o})})]})}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[s&&"success"!==n&&a.jsx("button",{onClick:resetUpload,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),s&&"idle"===n&&a.jsx("button",{onClick:handleUpload,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Upload & Process"}),"success"===n&&a.jsx("button",{onClick:resetUpload,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Upload Another File"})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Sample CSV Format"}),a.jsx("div",{className:"bg-gray-50 rounded-md p-4 overflow-x-auto",children:a.jsx("pre",{className:"text-sm text-gray-600",children:`sku,product_name,on_hand,backroom_units,shelf_units,avg_daily_sales,lead_time_days
SKU-001,Premium Shampoo,150,100,50,12.5,7
SKU-002,Conditioner,75,50,25,8.2,5
SKU-003,Body Lotion,200,150,50,15.3,10`})})]})]})}var h=s(5256),u=s(644),p=s(5574),g=s(9518);function ForecastSection(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(!0),[n,i]=(0,r.useState)("all"),[d,x]=(0,r.useState)(""),[m,y]=(0,r.useState)([]),[f,j]=(0,r.useState)(!1),[b,v]=(0,r.useState)(""),[N,w]=(0,r.useState)(null),[k,S]=(0,r.useState)(!1),[_,D]=(0,r.useState)(!1);(0,r.useEffect)(()=>{fetchForecastData()},[]);let fetchForecastData=async()=>{try{l(!0),t([{sku:"SKU-001",product_name:"Premium Shampoo",current_stock:150,daily_demand:12.5,days_remaining:12,reorder_point:100,suggested_order:200,priority:"High"},{sku:"SKU-002",product_name:"Conditioner",current_stock:75,daily_demand:8.2,days_remaining:9,reorder_point:50,suggested_order:150,priority:"High"},{sku:"SKU-003",product_name:"Body Lotion",current_stock:200,daily_demand:15.3,days_remaining:13,reorder_point:100,suggested_order:100,priority:"Medium"}])}catch(e){console.error("Error fetching forecast data:",e)}finally{l(!1)}},C=e.filter(e=>"all"===n||e.priority.toLowerCase()===n),generateInventoryHistory=async e=>{try{let t=await fetch(`/api/inventory/history/${e.sku}`);if(t.ok){let e=await t.json();return e.map(e=>({date:e.date,stock_level:e.stock_level,demand:e.demand,reorder_point:e.reorder_point}))}}catch(e){console.error("Error fetching real history data:",e)}let t=[],s=new Date;for(let a=29;a>=0;a--){let r=new Date(s);r.setDate(r.getDate()-a);let l=e.current_stock+(Math.random()-.5)*20,n=(Math.random()-.5)*10,i=Math.max(0,Math.round(l+n));t.push({date:r.toISOString().split("T")[0],stock_level:i,demand:e.daily_demand+(Math.random()-.5)*2,reorder_point:e.reorder_point})}return t},handleItemSelect=async t=>{let s=e.find(e=>e.sku===t);if(s){x(t);let e=await generateInventoryHistory(s);y(e),j(!0)}},getPriorityColor=e=>{switch(e){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-yellow-100 text-yellow-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},handleQuery=async()=>{if(b.trim()){D(!0),S(!1);try{let t=b.toLowerCase(),s="line";t.includes("compare")||t.includes("vs")?s="bar":t.includes("forecast")||t.includes("predict")?s="line":(t.includes("summary")||t.includes("total"))&&(s="pie");let a=[];if(t.includes("sku-001")||t.includes("shampoo")){let t=e.find(e=>"SKU-001"===e.sku);t&&(a=await generateInventoryHistory(t))}else if(t.includes("compare")||t.includes("all"))a=e.map(e=>({x:e.sku,y:e.current_stock,label:e.product_name}));else{let t=e[0];t&&(a=await generateInventoryHistory(t))}let r={type:s,title:`Query Result: ${b}`,data:a,xAxis:"bar"===s?"SKU":"Date",yAxis:"Stock Level"};w(r),S(!0)}catch(e){console.error("Error processing query:",e)}finally{D(!1)}}};return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reorder Planning & Forecast"}),a.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered inventory forecasting and reorder recommendations"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:fetchForecastData,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,a.jsxs)("button",{onClick:()=>{console.log("Downloading forecast data...")},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(p.Z,{className:"h-4 w-4 mr-2"}),"Download CSV"]})]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"all",label:"All Items",count:e.length},{id:"high",label:"High Priority",count:e.filter(e=>"High"===e.priority).length},{id:"medium",label:"Medium Priority",count:e.filter(e=>"Medium"===e.priority).length},{id:"low",label:"Low Priority",count:e.filter(e=>"Low"===e.priority).length}].map(e=>(0,a.jsxs)("button",{onClick:()=>i(e.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${n===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.label," (",e.count,")"]},e.id))})}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(h.Z,{className:"h-5 w-5 text-blue-400"})}),a.jsx("div",{className:"ml-3",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:[a.jsx("strong",{children:"Tip:"})," Click on any row in the table below to view the inventory trend chart for that item."]})})]})}),a.jsx(()=>{if(!f||0===m.length)return null;let t=e.find(e=>e.sku===d);if(!t)return null;let s=Math.max(...m.map(e=>e.stock_level)),r=m.map((e,t)=>{let a=40+t/(m.length-1)*720,r=40+(1-e.stock_level/s)*220;return{x:a,y:r,...e}});return(0,a.jsxs)("div",{className:"mt-6 bg-white p-6 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[a.jsx(h.Z,{className:"h-5 w-5 mr-2"}),"Inventory Trend: ",t.product_name," (",t.sku,")"]}),a.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),a.jsx("div",{className:"relative",children:(0,a.jsxs)("svg",{width:800,height:300,className:"border rounded",children:[[0,.25,.5,.75,1].map((e,t)=>(0,a.jsxs)("g",{children:[a.jsx("line",{x1:40,y1:40+220*e,x2:760,y2:40+220*e,stroke:"#e5e7eb",strokeWidth:1}),a.jsx("text",{x:30,y:40+220*e+5,textAnchor:"end",className:"text-xs fill-gray-500",children:Math.round(s*(1-e))})]},t)),m.filter((e,t)=>t%5==0).map((e,t)=>{let s=40+5*t/(m.length-1)*720;return a.jsx("text",{x:s,y:290,textAnchor:"middle",className:"text-xs fill-gray-500",children:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})},t)}),a.jsx("line",{x1:40,y1:40+(1-t.reorder_point/s)*220,x2:760,y2:40+(1-t.reorder_point/s)*220,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"5,5"}),(0,a.jsxs)("text",{x:765,y:40+(1-t.reorder_point/s)*220-5,className:"text-xs fill-red-600 font-medium",children:["Reorder Point (",t.reorder_point,")"]}),a.jsx("polyline",{points:r.map(e=>`${e.x},${e.y}`).join(" "),fill:"none",stroke:"#3b82f6",strokeWidth:3}),r.map((e,t)=>a.jsx("circle",{cx:e.x,cy:e.y,r:4,fill:"#3b82f6",className:"hover:r-6 transition-all cursor-pointer"},t))]})}),(0,a.jsxs)("div",{className:"mt-4 flex justify-between text-sm text-gray-600",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"Current Stock:"})," ",t.current_stock]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"Daily Demand:"})," ",t.daily_demand]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"Days Remaining:"})," ",t.days_remaining]})]})]})},{}),a.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Stock"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Daily Demand"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days Remaining"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reorder Point"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Suggested Order"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>handleItemSelect(e.sku),children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.sku}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.product_name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.current_stock}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.daily_demand}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsxs)("div",{className:"flex items-center",children:[e.days_remaining<10&&a.jsx(c.Z,{className:"h-4 w-4 text-yellow-400 mr-1"}),e.days_remaining," days"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.reorder_point}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.suggested_order}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getPriorityColor(e.priority)}`,children:e.priority})})]},e.sku))})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:a.jsx("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(o.Z,{className:"h-6 w-6 text-blue-400"})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Items Needing Reorder"}),a.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.filter(e=>e.current_stock<=e.reorder_point).length})]})})]})})}),a.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:a.jsx("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(c.Z,{className:"h-6 w-6 text-yellow-400"})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"High Priority Items"}),a.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.filter(e=>"High"===e.priority).length})]})})]})})}),a.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:a.jsx("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(o.Z,{className:"h-6 w-6 text-green-400"})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Suggested Orders"}),a.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.reduce((e,t)=>e+t.suggested_order,0)})]})})]})})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Ask Questions About Your Data"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",value:b,onChange:e=>v(e.target.value),onKeyPress:e=>"Enter"===e.key&&handleQuery(),placeholder:"e.g., Show me trends for SKU-001, Compare all products, Forecast next week",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsxs)("button",{onClick:handleQuery,disabled:_||!b.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[a.jsx(g.Z,{className:"h-4 w-4"}),a.jsx("span",{children:_?"Analyzing...":"Ask"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Try these examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:["Show me trends for SKU-001","Compare all products","Forecast next week","Summary of high priority items"].map((e,t)=>a.jsx("button",{onClick:()=>v(e),className:"text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-700 transition-colors",children:e},t))})]})]}),a.jsx(()=>{if(!k||!N)return null;let{type:e,title:t,data:s,xAxis:r,yAxis:l}=N;return(0,a.jsxs)("div",{className:"mt-6 bg-white p-6 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[a.jsx(h.Z,{className:"h-5 w-5 mr-2"}),t]}),a.jsx("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),a.jsx("div",{className:"relative",children:(0,a.jsxs)("svg",{width:800,height:300,className:"border rounded",children:["line"===e&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("polyline",{points:s.map((e,t)=>`${40+t/(s.length-1)*720},${260-e.y/Math.max(...s.map(e=>e.y))*200}`).join(" "),fill:"none",stroke:"#3b82f6",strokeWidth:3}),s.map((e,t)=>a.jsx("circle",{cx:40+t/(s.length-1)*720,cy:260-e.y/Math.max(...s.map(e=>e.y))*200,r:4,fill:"#3b82f6"},t))]}),"bar"===e&&a.jsx(a.Fragment,{children:s.map((e,t)=>{let r=e.y/Math.max(...s.map(e=>e.y))*200,l=720/s.length*.8,n=40+t/s.length*720+(720/s.length-l)/2,i=260-r;return(0,a.jsxs)("g",{children:[a.jsx("rect",{x:n,y:i,width:l,height:r,fill:"#3b82f6"}),a.jsx("text",{x:n+l/2,y:i-5,textAnchor:"middle",className:"text-xs fill-gray-600",children:e.y})]},t)})}),"pie"===e&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("circle",{cx:400,cy:150,r:80,fill:"#3b82f6",opacity:.3}),(0,a.jsxs)("text",{x:400,y:150,textAnchor:"middle",className:"text-sm fill-gray-600",children:[s.length," Items"]})]})]})}),a.jsx("div",{className:"mt-4 text-sm text-gray-600",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Chart Type:"})," ",e.toUpperCase()]}),(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Data Points:"})," ",s.length]})]})})]})},{})]})}var y=s(3560),f=s(3680),j=s(87),b=s(8089);function ChatInterface(){let[e,t]=(0,r.useState)([{id:"1",role:"assistant",content:"Hello! I'm your inventory assistant. I can help you with questions about stock levels, timelines, and forecasts. What would you like to know?",timestamp:new Date}]),[s,l]=(0,r.useState)(""),[n,i]=(0,r.useState)(!1),d=(0,r.useRef)(null),scrollToBottom=()=>{d.current?.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(()=>{scrollToBottom()},[e]);let handleSubmit=async e=>{if(e.preventDefault(),!s.trim()||n)return;let a={id:Date.now().toString(),role:"user",content:s.trim(),timestamp:new Date};t(e=>[...e,a]),l(""),i(!0);try{await new Promise(e=>setTimeout(e,1500));let e={id:(Date.now()+1).toString(),role:"assistant",content:`I understand you're asking about "${a.content}". This is a demo response. In the full implementation, I would connect to your Streamlit backend to provide real inventory insights, timeline information, and forecasting data.`,timestamp:new Date};t(t=>[...t,e])}catch(s){let e={id:(Date.now()+1).toString(),role:"assistant",content:"Sorry, I encountered an error. Please try again.",timestamp:new Date};t(t=>[...t,e])}finally{i(!1)}};return(0,a.jsxs)("div",{className:"h-[600px] flex flex-col bg-white rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 px-4 py-3 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(y.Z,{className:"h-6 w-6 text-blue-600 mr-2"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Inventory Assistant"})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Ask about inventory, timelines, or forecasts"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-4",children:[e.map(e=>a.jsx("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`flex max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${"user"===e.role?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:(0,a.jsxs)("div",{className:"flex items-start",children:["assistant"===e.role&&a.jsx(y.Z,{className:"h-4 w-4 mt-0.5 mr-2 flex-shrink-0"}),"user"===e.role&&a.jsx(f.Z,{className:"h-4 w-4 mt-0.5 mr-2 flex-shrink-0"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm",children:e.content}),a.jsx("p",{className:`text-xs mt-1 ${"user"===e.role?"text-blue-100":"text-gray-500"}`,children:e.timestamp.toLocaleTimeString()})]})]})})},e.id)),n&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"flex max-w-xs lg:max-w-md px-4 py-2 rounded-lg bg-gray-100 text-gray-900",children:(0,a.jsxs)("div",{className:"flex items-start",children:[a.jsx(y.Z,{className:"h-4 w-4 mt-0.5 mr-2 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(j.Z,{className:"h-4 w-4 animate-spin mr-2"}),a.jsx("span",{className:"text-sm",children:"Thinking..."})]})]})})}),a.jsx("div",{ref:d})]}),1===e.length&&(0,a.jsxs)("div",{className:"px-4 py-2 border-t border-gray-200",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Try asking:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:["What items are low in stock?","Show me the reorder plan for next week","What's the forecast for SKU-001?","Which products have the highest daily sales?","When will we run out of inventory?"].map((e,t)=>a.jsx("button",{onClick:()=>l(e),className:"text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-700 transition-colors",children:e},t))})]}),a.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-t border-gray-200",children:(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"Ask about inventory, timelines, or forecasts...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:n}),a.jsx("button",{type:"submit",disabled:!s.trim()||n,className:"px-4 py-2 bg-blue-600 text-white rounded-md shadow-sm text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(b.Z,{className:"h-4 w-4"})})]})})]})}var v=s(2875),N=s(9546);function ParquetUpload(){let[e,t]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),[n,i]=(0,r.useState)("idle"),[o,c]=(0,r.useState)(""),h=(0,r.useRef)(null),handleDrag=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?t(!0):"dragleave"===e.type&&t(!1)},handleFile=e=>{e.name.endsWith(".parquet")?(l(e),i("idle"),c("")):(i("error"),c("Please upload a Parquet file (.parquet)"))},handleUpload=async()=>{if(s){i("uploading"),c("");try{let e=new FormData;e.append("file",s);let t=await fetch("/api/upload/parquet",{method:"POST",body:e}),a=await t.json();t.ok?(i("success"),c("File uploaded successfully! Converted to JSON for frontend consumption."),a.filename&&console.log("File uploaded:",a.filename)):(i("error"),c(a.error||"Upload failed"))}catch(e){i("error"),c("Upload failed. Please try again.")}}},resetUpload=()=>{l(null),i("idle"),c(""),h.current&&(h.current.value="")};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(v.Z,{className:"h-5 w-5 mr-2"}),"Upload Parquet Data Files"]}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Upload Parquet files containing your inventory data. The system will automatically convert them to JSON for frontend consumption."}),(0,a.jsxs)("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center ${e?"border-blue-400 bg-blue-50":s?"border-green-400 bg-green-50":"border-gray-300"}`,onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:e=>{e.preventDefault(),e.stopPropagation(),t(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&handleFile(e.dataTransfer.files[0])},children:[a.jsx("input",{ref:h,type:"file",accept:".parquet",onChange:e=>{e.target.files&&e.target.files[0]&&handleFile(e.target.files[0])},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),s?(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(d.Z,{className:"mx-auto h-12 w-12 text-green-400"}),a.jsx("p",{className:"text-sm font-medium text-green-600",children:s.name}),(0,a.jsxs)("p",{className:"text-xs text-green-500",children:[(s.size/1024).toFixed(1)," KB"]})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(x.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium text-blue-600 hover:text-blue-500",children:"Click to upload"})," ","or drag and drop"]}),a.jsx("p",{className:"text-xs text-gray-500",children:"Parquet files only (.parquet)"})]})]}),o&&a.jsx("div",{className:`mt-4 p-4 rounded-md ${"success"===n?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:"success"===n?a.jsx(d.Z,{className:"h-5 w-5 text-green-400"}):a.jsx(m.Z,{className:"h-5 w-5 text-red-400"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:`text-sm font-medium ${"success"===n?"text-green-800":"text-red-800"}`,children:o})})]})}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[s&&"success"!==n&&a.jsx("button",{onClick:resetUpload,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),s&&"idle"===n&&a.jsx("button",{onClick:handleUpload,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Upload & Convert"}),"success"===n&&a.jsx("button",{onClick:resetUpload,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Upload Another File"})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Expected Parquet File Format"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-md p-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Your Parquet file should contain the following columns:"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"sku"})," - Product SKU (string)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"product_name"})," - Product name (string)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"category"})," - Product category (string, optional)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"on_hand"})," - Current stock level (number)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"backroom_units"})," - Backroom inventory (number)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"shelf_units"})," - Shelf inventory (number)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"avg_daily_sales"})," - Average daily sales (number)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"lead_time_days"})," - Lead time in days (number)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"cost_per_unit"})," - Cost per unit (number, optional)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"selling_price"})," - Selling price (number, optional)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"supplier"})," - Supplier name (string, optional)"]}),(0,a.jsxs)("li",{children:[a.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"last_updated"})," - Last update timestamp (string, optional)"]})]})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(N.Z,{className:"h-5 w-5 text-blue-400"})}),(0,a.jsxs)("div",{className:"ml-3",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Conversion Process"}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"After uploading, use the Python script to convert Parquet to JSON:"}),a.jsx("code",{className:"block mt-2 text-xs bg-blue-100 p-2 rounded",children:"python scripts/convert_parquet.py data/your_file.parquet"})]})]})})]})}var w=s(6574);let QueryParser=class QueryParser{static{this.keywords={trend:["trend","over time","change","growth","decline","pattern"],comparison:["compare","vs","versus","against","difference","better","worse"],forecast:["forecast","predict","future","projection","estimate","will"],analysis:["analyze","analysis","insight","why","reason","cause"],summary:["summary","overview","total","sum","average","mean"]}}static{this.timeframes={"last week":7,"last month":30,"last 3 months":90,"last 6 months":180,"last year":365,"this week":7,"this month":30,"this year":365}}static{this.metrics={"stock level":"stock_level",inventory:"stock_level",sales:"demand",demand:"demand",revenue:"revenue",cost:"cost",profit:"profit"}}static parseQuery(e){let t=e.toLowerCase(),s="trend";for(let[e,a]of Object.entries(this.keywords))if(a.some(e=>t.includes(e))){s=e;break}let a=this.extractEntities(t),r=this.extractTimeframe(t),l=this.extractMetric(t),n=this.extractFilters(t);return{type:s,entities:a,timeframe:r,metric:l,filters:n}}static extractEntities(e){let t=[],s=e.match(/sku-?\w+/gi);for(let a of(s&&t.push(...s.map(e=>e.toUpperCase())),["fresh produce","dairy","meat","bakery","beverages","snacks","frozen","health","beauty","household"]))e.includes(a)&&t.push(a);for(let s of["shampoo","milk","bread","apple","chicken","egg"])e.includes(s)&&t.push(s);return t}static extractTimeframe(e){for(let[t,s]of Object.entries(this.timeframes))if(e.includes(t))return t}static extractMetric(e){for(let[t,s]of Object.entries(this.metrics))if(e.includes(t))return s;return"stock_level"}static extractFilters(e){let t={};return e.includes("high priority")||e.includes("urgent")?t.priority="High":e.includes("low priority")&&(t.priority="Low"),e.includes("low stock")||e.includes("out of stock")?t.stockLevel="low":(e.includes("high stock")||e.includes("overstocked"))&&(t.stockLevel="high"),t}};let GraphGenerator=class GraphGenerator{static generateGraph(e,t){switch(e.type){case"trend":default:return this.generateTrendGraph(e,t);case"comparison":return this.generateComparisonGraph(e,t);case"forecast":return this.generateForecastGraph(e,t);case"analysis":return this.generateAnalysisGraph(e,t);case"summary":return this.generateSummaryGraph(e,t)}}static generateTrendGraph(e,t){let s=e.metric||"stock_level";return e.timeframe,{type:"line",title:`Trend Analysis: ${s.replace("_"," ").toUpperCase()}`,xAxis:"Date",yAxis:s.replace("_"," ").toUpperCase(),data:t.map(e=>({x:e.date,y:e[s],label:e.sku})),options:{responsive:!0,scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:s.replace("_"," ").toUpperCase()}}}}}}static generateComparisonGraph(e,t){let s=e.metric||"stock_level";return{type:"bar",title:`Comparison: ${s.replace("_"," ").toUpperCase()}`,xAxis:"SKU",yAxis:s.replace("_"," ").toUpperCase(),data:t.map(e=>({x:e.sku,y:e[s],label:e.product_name})),options:{responsive:!0,scales:{x:{title:{display:!0,text:"SKU"}},y:{title:{display:!0,text:s.replace("_"," ").toUpperCase()}}}}}}static generateForecastGraph(e,t){let s=e.metric||"stock_level",a=this.generateForecastData(t,s);return{type:"line",title:`Forecast: ${s.replace("_"," ").toUpperCase()}`,xAxis:"Date",yAxis:s.replace("_"," ").toUpperCase(),data:a,options:{responsive:!0,scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:s.replace("_"," ").toUpperCase()}}}}}}static generateAnalysisGraph(e,t){let s=e.metric||"stock_level";return{type:"scatter",title:`Analysis: ${s.replace("_"," ").toUpperCase()} vs Demand`,xAxis:"Demand",yAxis:s.replace("_"," ").toUpperCase(),data:t.map(e=>({x:e.demand,y:e[s],label:e.sku})),options:{responsive:!0,scales:{x:{title:{display:!0,text:"Demand"}},y:{title:{display:!0,text:s.replace("_"," ").toUpperCase()}}}}}}static generateSummaryGraph(e,t){let s=e.metric||"stock_level";return{type:"pie",title:`Summary: ${s.replace("_"," ").toUpperCase()} Distribution`,xAxis:"Category",yAxis:"Value",data:t.map(e=>({label:e.sku,value:e[s]})),options:{responsive:!0}}}static generateForecastData(e,t){let s=e.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),a=s[s.length-1]?.[t]||0,r=this.calculateTrend(s,t),l=[...s];for(let e=1;e<=7;e++){let t=new Date;t.setDate(t.getDate()+e);let s=a+r*e;l.push({x:t.toISOString().split("T")[0],y:Math.max(0,s),label:"Forecast",isForecast:!0})}return l}static calculateTrend(e,t){if(e.length<2)return 0;let s=e.map(e=>e[t]),a=s.length,r=a*(a-1)/2,l=s.reduce((e,t)=>e+t,0),n=s.reduce((e,t,s)=>e+s*t,0);return(a*n-r*l)/(a*(a*(a-1)*(2*a-1)/6)-r*r)}};function DynamicGraph({config:e,width:t=800,height:s=400}){let l=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!l.current)return;let a=l.current,r=a.getContext("2d");if(r)switch(r.clearRect(0,0,t,s),e.type){case"line":drawLineChart(r,e,t,s);break;case"bar":drawBarChart(r,e,t,s);break;case"scatter":drawScatterChart(r,e,t,s);break;case"area":drawAreaChart(r,e,t,s);break;case"pie":drawPieChart(r,e,t,s)}},[e,t,s]);let drawLineChart=(e,t,s,a)=>{let r=s-120,l=a-120,n=t.data.map(e=>e.y),i=Math.min(...n),d=Math.max(...n)-i||1;e.strokeStyle="#374151",e.lineWidth=2,e.beginPath(),e.moveTo(60,60),e.lineTo(60,a-60),e.lineTo(s-60,a-60),e.stroke(),e.strokeStyle="#e5e7eb",e.lineWidth=1;for(let t=0;t<=5;t++){let a=60+t/5*l;e.beginPath(),e.moveTo(60,a),e.lineTo(s-60,a),e.stroke()}e.strokeStyle="#3b82f6",e.lineWidth=3,e.beginPath(),t.data.forEach((s,n)=>{let o=60+n/(t.data.length-1)*r,c=a-60-(s.y-i)/d*l;0===n?e.moveTo(o,c):e.lineTo(o,c)}),e.stroke(),e.fillStyle="#3b82f6",t.data.forEach((s,n)=>{let o=60+n/(t.data.length-1)*r,c=a-60-(s.y-i)/d*l;e.beginPath(),e.arc(o,c,4,0,2*Math.PI),e.fill()}),e.fillStyle="#374151",e.font="12px sans-serif",e.textAlign="center",e.fillText(t.title,s/2,20),e.textAlign="right";for(let t=0;t<=5;t++){let s=i+t/5*d,a=60+t/5*l;e.fillText(s.toFixed(0),50,a+4)}},drawBarChart=(e,t,s,a)=>{let r=s-120,l=a-120,n=t.data.map(e=>e.y),i=Math.max(...n),d=r/t.data.length*.8;e.strokeStyle="#374151",e.lineWidth=2,e.beginPath(),e.moveTo(60,60),e.lineTo(60,a-60),e.lineTo(s-60,a-60),e.stroke(),t.data.forEach((s,n)=>{let o=s.y/i*l,c=60+n/t.data.length*r+(r/t.data.length-d)/2,x=a-60-o;e.fillStyle="#3b82f6",e.fillRect(c,x,d,o),e.fillStyle="#374151",e.font="10px sans-serif",e.textAlign="center",e.fillText(s.y.toFixed(0),c+d/2,x-5)}),e.fillStyle="#374151",e.font="12px sans-serif",e.textAlign="center",e.fillText(t.title,s/2,20)},drawScatterChart=(e,t,s,a)=>{let r=s-120,l=a-120,n=t.data.map(e=>e.x),i=t.data.map(e=>e.y),d=Math.min(...n),o=Math.min(...i),c=Math.max(...n)-d||1,x=Math.max(...i)-o||1;e.strokeStyle="#374151",e.lineWidth=2,e.beginPath(),e.moveTo(60,60),e.lineTo(60,a-60),e.lineTo(s-60,a-60),e.stroke(),e.fillStyle="#3b82f6",t.data.forEach(t=>{let s=60+(t.x-d)/c*r,n=a-60-(t.y-o)/x*l;e.beginPath(),e.arc(s,n,6,0,2*Math.PI),e.fill()}),e.fillStyle="#374151",e.font="12px sans-serif",e.textAlign="center",e.fillText(t.title,s/2,20)},drawAreaChart=(e,t,s,a)=>{let r=s-120,l=a-120,n=t.data.map(e=>e.y),i=Math.min(...n),d=Math.max(...n)-i||1;e.fillStyle="rgba(59, 130, 246, 0.3)",e.beginPath(),t.data.forEach((s,n)=>{let o=60+n/(t.data.length-1)*r,c=a-60-(s.y-i)/d*l;0===n&&e.moveTo(o,a-60),e.lineTo(o,c)}),e.lineTo(s-60,a-60),e.closePath(),e.fill(),e.strokeStyle="#3b82f6",e.lineWidth=3,e.beginPath(),t.data.forEach((s,n)=>{let o=60+n/(t.data.length-1)*r,c=a-60-(s.y-i)/d*l;0===n?e.moveTo(o,c):e.lineTo(o,c)}),e.stroke(),e.fillStyle="#374151",e.font="12px sans-serif",e.textAlign="center",e.fillText(t.title,s/2,20)},drawPieChart=(e,t,s,a)=>{let r=s/2,l=a/2,n=Math.min(s,a)/2-40,i=t.data.reduce((e,t)=>e+t.value,0),d=0,o=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#06b6d4"];t.data.forEach((t,s)=>{let a=t.value/i*2*Math.PI;e.fillStyle=o[s%o.length],e.beginPath(),e.moveTo(r,l),e.arc(r,l,n,d,d+a),e.closePath(),e.fill();let c=d+a/2,x=r+Math.cos(c)*(n+20),m=l+Math.sin(c)*(n+20);e.fillStyle="#374151",e.font="10px sans-serif",e.textAlign="center",e.fillText(t.label,x,m),e.fillText(t.value.toFixed(0),x,m+12),d+=a}),e.fillStyle="#374151",e.font="12px sans-serif",e.textAlign="center",e.fillText(t.title,s/2,20)};return a.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:a.jsx("canvas",{ref:l,width:t,height:s,className:"border rounded"})})}function QueryInterface({inventoryData:e=[],historyData:t=[]}){let[s,l]=(0,r.useState)(""),[n,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[x,m]=(0,r.useState)(!1),[u,p]=(0,r.useState)([]),[y,f]=(0,r.useState)([]);(0,r.useEffect)(()=>{let fetchInventoryData=async()=>{try{let e=await fetch("/api/inventory/real");if(e.ok){let t=await e.json();f(t)}}catch(e){console.error("Error fetching inventory data:",e)}};fetchInventoryData()},[]);let handleQuery=async()=>{if(s.trim()){m(!0);try{let e=QueryParser.parseQuery(s);i(e);let t=await generateDataForIntent(e),a=GraphGenerator.generateGraph(e,t);c(a),p(e=>[s,...e.slice(0,4)])}catch(e){console.error("Error processing query:",e)}finally{m(!1)}}},generateDataForIntent=async e=>{if(e.entities.some(e=>e.startsWith("SKU-"))){let t=e.entities.find(e=>e.startsWith("SKU-"));if(t)try{let e=await fetch(`/api/inventory/history/${t}`);if(e.ok)return await e.json()}catch(e){console.error("Error fetching history data:",e)}}if(e.entities.some(e=>["fresh produce","dairy","meat","bakery","beverages"].includes(e))){let t=e.entities.find(e=>["fresh produce","dairy","meat","bakery","beverages"].includes(e));return y.filter(e=>e.category?.toLowerCase().includes(t||""))}return y};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Ask a Question About Your Data"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",value:s,onChange:e=>l(e.target.value),onKeyPress:e=>"Enter"===e.key&&handleQuery(),placeholder:"e.g., Show me stock trends for SKU-001 over the last month",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsxs)("button",{onClick:handleQuery,disabled:x||!s.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[a.jsx(g.Z,{className:"h-4 w-4"}),a.jsx("span",{children:x?"Analyzing...":"Ask"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Try these examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:["Show me stock trends for SKU-001 over the last month","Compare inventory levels across all products","Forecast demand for the next week","Analyze the relationship between sales and stock levels"].map((e,t)=>a.jsx("button",{onClick:()=>l(e),className:"text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-700 transition-colors",children:e},t))})]})]}),n&&(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900 mb-2",children:"Query Analysis"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium ${(e=>{switch(e.type){case"trend":return"text-blue-600 bg-blue-100";case"comparison":return"text-green-600 bg-green-100";case"forecast":return"text-purple-600 bg-purple-100";case"analysis":return"text-orange-600 bg-orange-100";case"summary":return"text-pink-600 bg-pink-100";default:return"text-gray-600 bg-gray-100"}})(n)}`,children:[(e=>{switch(e.type){case"trend":case"forecast":return a.jsx(o.Z,{className:"h-4 w-4"});case"comparison":case"analysis":default:return a.jsx(h.Z,{className:"h-4 w-4"});case"summary":return a.jsx(w.Z,{className:"h-4 w-4"})}})(n),a.jsx("span",{children:n.type.toUpperCase()})]}),n.entities.length>0&&(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Entities:"})," ",n.entities.join(", ")]}),n.timeframe&&(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Timeframe:"})," ",n.timeframe]}),n.metric&&(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Metric:"})," ",n.metric]})]})]}),d&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Generated Visualization"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[d.type.toUpperCase()," Chart"]})]}),a.jsx(DynamicGraph,{config:d})]}),u.length>0&&(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900 mb-2",children:"Recent Queries"}),a.jsx("div",{className:"space-y-2",children:u.map((e,t)=>a.jsx("button",{onClick:()=>l(e),className:"block w-full text-left text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 p-2 rounded transition-colors",children:e},t))})]})]})}async function apiGet(e){let t=process.env.NEXT_PUBLIC_API_URL??"",s=await fetch(`${t}${e}`,{cache:"no-store"});if(!s.ok)throw Error("Network response was not ok");return s.json()}let k=process.env.NEXT_PUBLIC_API_URL||"(unset)";function Home(){let[e,t]=(0,r.useState)("overview"),[s,i]=(0,r.useState)("All Categories"),[d,o]=(0,r.useState)(!1),[c,x]=(0,r.useState)("unknown"),[m,h]=(0,r.useState)(!1),u=(0,r.useRef)(null);(0,r.useEffect)(()=>{let handleClickOutside=e=>{u.current&&!u.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",handleClickOutside),()=>document.removeEventListener("mousedown",handleClickOutside)},[]);let p=(0,r.useCallback)(async()=>{h(!0);try{await apiGet("/health"),x("ok")}catch{x("down")}finally{h(!1)}},[]);return(0,r.useEffect)(()=>{p()},[p]),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"relative",ref:u,children:[(0,a.jsxs)("button",{onClick:()=>o(!d),className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx("span",{children:"\uD83D\uDED2"}),a.jsx("span",{children:s}),a.jsx(l.Z,{className:"h-4 w-4"})]}),d&&a.jsx("div",{className:"absolute z-10 mt-1 w-56 bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none",children:["All Categories","Fresh Produce","Dairy & Eggs","Meat & Seafood","Bakery","Pantry Staples","Beverages","Snacks","Frozen Foods","Health & Beauty","Household Items","Baby & Kids","Pet Supplies","Organic & Natural","International Foods"].map(e=>a.jsx("button",{onClick:()=>{i(e),o(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${s===e?"bg-blue-50 text-blue-600":"text-gray-900"}`,children:e},e))})]}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Backroom — Inventory Intelligence"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:["ok"===c&&a.jsx("span",{title:`Backend: ${k}`,className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"API Connected"}),"down"===c&&a.jsx("span",{title:`Backend: ${k}`,className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"API Down"}),"unknown"===c&&a.jsx("span",{title:`Backend: ${k}`,className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Checking API…"}),(0,a.jsxs)("button",{onClick:p,disabled:m,className:"inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-50",title:"Re-check API health",children:[a.jsx(n.Z,{className:`h-3.5 w-3.5 ${m?"animate-spin":""}`}),"Retry"]}),a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"DuckDB Connected"})]})]})})}),a.jsx("nav",{className:"bg-white shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"flex space-x-8",children:[{id:"overview",label:"Overview",icon:"\uD83D\uDCCA"},{id:"upload",label:"Upload & Clean",icon:"\uD83D\uDCE4"},{id:"parquet",label:"Parquet Data",icon:"\uD83D\uDDC4️"},{id:"query",label:"Query Graphs",icon:"\uD83D\uDD0D"},{id:"forecast",label:"Forecast",icon:"\uD83D\uDD2E"},{id:"chat",label:"AI Chat",icon:"\uD83D\uDCAC"}].map(s=>(0,a.jsxs)("button",{onClick:()=>t(s.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${e===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx("span",{className:"mr-2",children:s.icon}),s.label]},s.id))})})}),a.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:["overview"===e&&a.jsx(InventoryDashboard,{}),"upload"===e&&a.jsx(UploadSection,{}),"parquet"===e&&a.jsx(ParquetUpload,{}),"query"===e&&a.jsx(QueryInterface,{}),"forecast"===e&&a.jsx(ForecastSection,{}),"chat"===e&&a.jsx(ChatInterface,{})]})})]})}},3982:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>d});var a=s(5153);let r=(0,a.createProxy)(String.raw`/Users/dhiraja/Documents/Projects/backroom/app/page.tsx`),{__esModule:l,$$typeof:n}=r,i=r.default,d=i}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[214,690,358],()=>__webpack_exec__(1778));module.exports=s})();